(function(e){function q(b,d){var a=b.cache[b.source],h={};if(a)for(var f in a){if(f===d){l(b,a[f],d);return}}else a=b.cache[b.source]={};b.query&&(h[b.search]=d,d=e.extend({},b.query,h));e.D({url:b.source,data:d,method:b.method||"get",dataType:b.type||"json"}).done(function(e){e=b.normalize(e);a[d]=e;l(b,e,d)}).I(function(a){b.target.u("error",a)})}function n(b,d){var a=q;d&&(d=e.trim(d.toLowerCase()));Array.isArray(b.source)&&(a=function(){l(b,b.source,d)});b.s&&(clearTimeout(b.s),b.s=null);b.s=
setTimeout(function(){a(b,d)},b.A)}function l(b,d,a){function h(a){var g="";Object.keys(a).forEach(function(d,c){g+="<"+b.a+">\n";g+="<"+b.b+' title="'+d+'" data-row="'+c+'">\n';g+=k(a[d]);g+="</"+b.b+">\n";g+="</"+b.a+">\n"});return g}function f(a,d){var c,e=a.title||"&nbsp;",m=!!a.j;c=""+("<"+b.a+' title="'+e+'" data-row="'+d+'">');c=a.url?c+('<a href="'+a.url+'">'):c+"<div>";a.o&&(c+='<img src="'+a.o+'">');c+="<h4>"+e+"</h4>";a.description&&(c+="<p>"+a.description+"</p>");a.j&&(c+="<i>"+a.j+"</i>");
a.m&&(c+='<b class="'+(m?"discount":"")+'">'+a.m+"</b>");c=a.url?c+"</a>":c+"</div>";return c+="</"+b.a+">\n"}function k(a){var c="";"object"===typeof a?Array.isArray(a)?a.forEach(function(a){"string"===typeof a?(c+="<"+b.a+">",c+=a,c+="</"+b.a+">\n"):c+=f(a)}):Object.keys(a).forEach(function(b){c+=h(a[b])}):(c+="<"+b.a+">",c+=a,c+="</"+b.a+">\n");return c}var m=e(b.b,b.f),c="";if(a&&"function"===typeof b.filter)return l(b,b.filter(d,a));b.f.data("results",d);a=0;for(var p=d.length;a<p;a++)"object"===
typeof d[a]?c+=f(d[a],a):(0===a&&(c+="<"+b.a+">\n",c+="<"+b.b+">\n"),c+=k(d[a]),a===p-1&&(c+="</"+b.b+">\n",c+="</"+b.a+">\n"));c||(b.l?(c+="<"+b.a+' title="'+b.l+'">',c+=b.l,c+="</"+b.a+">\n"):b.toggle(!1));m.M(c);return this}function r(b){function d(b){var c=a.f.data("results"),d=e(b).w("data-row"),f=e(b).w("href");f||(f=e(b).find("a").first().w("href"));a.target.u("selected",f,c[d])}b=b||{};if(Array.isArray(b)||"string"===typeof b)b={source:b};var a=e.extend({},t,b);b=[a.b,a.a].join(" ");a.target=
e(this);if(0>a.c.indexOf("id=")){var h=a.c.indexOf(">");if(0>h)throw new TypeError("wrapper");a.className=a.h+"-wrapper";a.id=a.h+u++;a.c=a.c.substr(0,h-1)+' id="'+a.id+'" class="'+a.className+'"'+a.c.substr(h,a.c.length)}e(this).P(a.c);a.f=e("#"+a.id);e("<"+a.b+' class="'+a.h+'"></'+a.b+">\n").F(a.f);a.B=e(a.b,a.f);a.toggle=function(b){a.visible=void 0===b?!a.visible:b;a.visible?(a.B.show(a.v),a.target.u("show")):(a.B.L(a.v),a.target.u("hide"))};a.toggle(a.visible);a.i||n(a,null);var f="",k=!1;a.f.g("touchstart",
b,function(a){k=a.timeStamp}).g("touchend",b,function(b){var c;c=b.timeStamp-k;b.preventDefault();b.stopPropagation();c<a.threshold&&d(this);return!1}).g("click",b,function(a){a.preventDefault();d(this)}).g("keyup","input",function(){this.value!==f&&(f=this.value,f.length>=a.i?(n(a,f),a.toggle(!0)):a.toggle(!1))}).g("click","input",function(){this.value.length>=a.i&&a.toggle()}).g("blur","input",function(){setTimeout(function(){a.toggle(!1)},a.A)});return this}var t={source:"/search.json",l:void 0,
h:"asearch",visible:!1,c:"<div/>",v:300,search:"q",A:200,threshold:250,i:3,cache:{},b:"ul",a:"li",query:{type:"product",J:["title","url","thumbnail","price","compare_at_price"],N:0},normalize:function(b){return b.results?b.results.map(function(b){return{url:b.url,title:b.title,o:b.o,description:b.O,m:b.m,j:b.G}}):[]}},u=0;e.K.C=function(){var b=Array.prototype.slice.call(arguments);return e.data(this,"aSearch")?this:e(this).H(function(){r.apply(this,b);e.data(this,"aSearch")})}})(jQuery);